function ajax_request_type(e,t,n,a){var i;if("undefined"!=typeof XMLHttpRequest)i=new XMLHttpRequest;else for(var o=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],s=0,r=o.length;s<r;s++)try{i=new ActiveXObject(o[s]);break}catch(e){}i.onreadystatechange=function(){if(i.readyState<4)return;if(200!==i.status)return;4===i.readyState&&a(i)},i.open(e,t,!0),"POST"==e&&i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(n)}function ajax_request(e,t){ajax_request_type("GET",e,"",t)}function ajax_post(e,t,n){ajax_request_type("POST",e,t,n)}function on(e,t,n){e.addEventListener?e.addEventListener(t,function(){n(e,t)},!1):e.attachEvent&&e.attachEvent(t,function(){n(e,t)})}for(var inputs=document.getElementsByTagName("input"),i=0;i<inputs.length;i++)"range"==inputs[i].type.toLowerCase()?["change","input"].forEach(function(e){on(inputs[i],e,function(e,t){"input"==t&&(document.getElementById(e.name).innerHTML=e.value)})}):"checkbox"==inputs[i].type.toLowerCase()&&"relay"==inputs[i].getAttribute("rel")&&["change","input"].forEach(function(e){on(inputs[i],e,function(e,t){if("change"==t){var n=1-parseInt(e.getAttribute("value"));ajax_request("/gpio?pin="+e.name.substr(5)+"&st="+n,function(){e.setAttribute("value",n),e.checked=n,document.getElementById(e.name).innerHTML=n?"ON":"OFF"})}"input"==t&&(document.getElementById(e.name).innerHTML=e.checked?"ON":"OFF")})});var a=document.getElementsByTagName("a");for(i=0;i<a.length;i++)"relay"==a[i].getAttribute("rel")&&on(a[i],"click",function(e,t){var n=1-parseInt(e.getAttribute("data-val"));ajax_request("/gpio?st="+n+"&pin="+e.getAttribute("data-id"),function(){e.setAttribute("data-val",n),e.innerHTML="<button class='relay "+(n?"on":"off")+"' >"+e.getAttribute("data-title")+"</button>"})});function effects(){var e=document.getElementById("effects"),t=e.options[e.selectedIndex].value;e.options[e.selectedIndex].text;ajax_request("/colors?type=effect&id="+t,function(){e.options[t].selected="true"})}function reboot(){ajax_request("/reboot?st=1",setTimeout(function(){window.location.replace("/")},3e3)),document.getElementById("rbt").style.display="block"}function i2cscan(){ajax_request("/i2cscan?st=1",function(e){document.getElementById("i2cres").innerHTML="<h4>Результаты сканирования:</h4><p>"+e.responseText+"</p>"})}function btnclick(e,t,n,a){var i=document.getElementById(e),o=i.getAttribute("data-uri"),s=i.getAttribute("data-val"),r=o;s>-1&&(r=o+s),ajax_request(r,function(e){if(1==a){var o=0,r=e.responseText;o="OFF"==r?0:0==r?0:"ON"==r?1:1==r?1:"ERROR"==r?s:"OK"==r?!s:0;var c=i.getAttribute("data-class"),u=o>0?" on":" off";i.setAttribute("class",c+u),i.setAttribute("data-val",1-o)}var l=document.getElementById(t);if(1==n)l.innerHTML=i.getAttribute("data-text")+e.responseText;else if(2==n){var d=i.getAttribute("data-text");l.innerHTML=d.replace("{0}",e.responseText)}else l.innerHTML=i.getAttribute("data-text")})}function change_color(e,t){if(t.indexOf("ledc10")>=0){var n=document.getElementById("colors").getAttribute("style"),a=(n=(n=n.substr(15,n.length)).substr(0,n.length-1)).split(",");"ledc100"==t?a[0]=e:"ledc101"==t?a[1]=e:"ledc102"==t&&(a[2]=e),n="background:rgb("+(n=a.join())+")",document.getElementById("colors").setAttribute("style",n)}}function slider(e,t,n){change_color(e,t),ajax_request(n+e,function(e){var n=e.responseText;document.getElementById(t).innerHTML=n})}function otaGet(e){var t=document.getElementById("selectedFile").files[0],n="<h4>File: "+t.name+"<br>Size: "+t.size+" bytes</h4>";t.size>e&&(n+="<h4 style='color: red;'>Files size is bigger than partition size!!!</h4>"),document.getElementById("file_info").innerHTML=n}function updFw(){var e=document.getElementById("selectedFile");if(e.files&&1==e.files.length){var t=e.files[0];document.getElementById("ota_process").innerHTML="Uploading "+t.name+" , Please Wait..."}else window.alert("Select A File First")}function mqttsubs(e,t){console.log("base"+e),console.log("endpt"+e),ajax_post("/mqttsub","id="+e+"&base="+document.getElementsByName("base"+e)[0].value+"&endpt="+document.getElementsByName("endpt"+e)[0].value+"&act="+t,function(e){console.log(e.responseText),document.location.reload()})}function mqttsuba(e,t,n){var a=document.getElementById(e),i=(document.createElement("div"),"<div id='basetop'>");i+="<hr>",i+="<p><label class='lf'>Base topic "+(t+1)+": </label><input size='20' name='base"+t+"' class='edit rh' /></p>",i+="<p><label class='lf'>endpoints: </label><input size='20' name='endpt"+t+"' class='edit rh' /></p>",i+="<p class='lf2'>",i+="<button class='button norm rht' onclick='mqttsubs("+t+",0)'>Set</button>",i+="<button class='button norm rht' onclick='mqttsubs("+t+",1)'>Del</button>",i+="</p>",i+="</div>",a.innerHTML=a.innerHTML+i}